<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:Rutinas="clr-namespace:AnotadorGymApp.Datos"
             x:Class="AnotadorGymApp.RutinasPage.PrincipalRutinasPage"
             Shell.NavBarIsVisible="False"
             Title="Rutinas">


    <ScrollView Padding="10" Margin="0">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
            </Grid.RowDefinitions>

            <Button x:Name="AÃ±adirRutinaButton" Margin="0,0,0,10" Padding="0" Grid.Row="0"
                    Text="âž• Agregar Rutina"
                    FontSize="14"
                    HeightRequest="50"
                    IsVisible="True"
                    Clicked="AÃ±adirRutinaButton_Clicked"/>
            
            <CollectionView ItemsSource="{Binding rutinas}" HorizontalOptions="Center" BackgroundColor="Transparent" Grid.Row="1">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout ItemSpacing="10" Orientation="Vertical"></LinearItemsLayout>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid IsClippedToBounds="False">
                            <Border Style="{DynamicResource BorderWithShadowStyle}" Margin="0">
                            <Grid BackgroundColor="{DynamicResource CardBackground}" Margin="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="40" />
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <Label Text="{Binding Nombre}" FontAttributes="Bold" Style="{StaticResource SubHeadline}"
                                        Grid.Row="0" Grid.Column="0" VerticalOptions="Center" HorizontalOptions="Start" />
                                <Button Text="âœï¸" FontSize="14" Margin="10,0" Grid.Row="0" Grid.Column="1" HorizontalOptions="End"                                       
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}},Path=EditRutinaCommand}" CommandParameter="{Binding .}" Padding="0" />
                                <Button Text="ðŸ—‘ï¸" FontSize="14"
                                        Grid.Row="0" Grid.Column="2" HorizontalOptions="End" Clicked="EliminarRutina_Clicked" Padding="0" />
                                <Label Text="{Binding CountDiasPrimeraSemana, StringFormat='DÃ­as: {0}'}" Grid.Row="1" Grid.ColumnSpan="3" Style="{StaticResource SubHeadline}"/>
                                <Label Text="{Binding Semanas.Count, StringFormat='Semanas: {0}'}" Grid.Row="1" Style="{StaticResource SubHeadline}" HorizontalOptions="Start"/>
                                <Label Text="{Binding Descripcion}" Grid.Row="2" Grid.ColumnSpan="3" Style="{StaticResource SubHeadline}" LineBreakMode="WordWrap" HorizontalOptions="Center"/>
                                <Button Text="Empezar Rutina" Grid.Row="2" Grid.ColumnSpan="3" Margin="0,8,0,0"
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=StarRutinaCommand}"
                                    CommandParameter="{Binding .}"></Button>
                            </Grid>
                        </Border>
                            
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>
    </ScrollView>


</ContentPage>